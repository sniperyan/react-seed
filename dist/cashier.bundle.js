webpackJsonp(["cashier"],{"0u8huDBA":function(e,t,a){t=e.exports=a("FZ+f8GH+")(!0),t.push([e.i,"._WnihOna .item.disabled img{-webkit-filter:grayscale(100%);filter:grayscale(100%)}._WnihOna .list.wallet{margin:0 -15px -16px}","",{version:3,sources:["/Users/smilelegend/workstation/exui-react/src/modules/cashier/style.less","/Users/smilelegend/workstation/exui-react/style.less"],names:[],mappings:"AAEA,6BAGM,+BAAA,sBAAA,CCHL,ADAD,uBASI,oBAAA,CCNH",file:"style.less",sourcesContent:['@import "../../less/base/fn.less";\n\n:local(.home) {\n  .item.disabled {\n    img {\n      filter: grayscale(100%);\n    }\n\n  }\n\n  .list.wallet {\n    margin: 0 -15px -16px;\n  }\n\n}\n',":local(.home) .item.disabled img {\n  filter: grayscale(100%);\n}\n:local(.home) .list.wallet {\n  margin: 0 -15px -16px;\n}\n"],sourceRoot:""}]),t.locals={home:"_WnihOna"}},"1nGpSJ/k":function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a("Zx67aMzV"),s=l(n),c=a("ZrlrdyRl"),r=l(c),u=a("wxAWXU5K"),i=l(u),o=a("zwoOJdCg"),d=l(o),m=a("Pf15lzEx"),f=l(m),p=a("GiK3r5kD"),h=l(p),E=a("RH2OZSPu"),v=a("pAQWTaDD"),g=a("6KlIuleq"),y=function(e){function t(){return(0,r.default)(this,t),(0,d.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,f.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this;return h.default.createElement(v.View,null,h.default.createElement(v.Header,null,h.default.createElement("a",{className:"menu",onClick:function(){return e.props.history.go(-1)}},h.default.createElement("i",{className:"icon"},"")),h.default.createElement(v.Title,{title:"支付失败"})),h.default.createElement(v.Content,null,h.default.createElement("div",{className:"feedback compact"},h.default.createElement("div",{className:"mark"},h.default.createElement("i",{className:"icon text-warning"},"")),h.default.createElement("h3",{className:"title"},"支付失败"),h.default.createElement("p",{className:"describe"},"非常抱歉，您可以返回订单尝试重新发起支付",h.default.createElement("br",null),"您也可以致电 ",h.default.createElement("a",{className:"link",href:"tel:4000818181"},"4000818181")," 咨询"),h.default.createElement("div",{className:"vspace hspace"},h.default.createElement("button",{className:"button plain-warning",onClick:function(){return e.props.history.go(-1)}},"重新支付"),h.default.createElement("button",{className:"button default",onClick:function(){return g.JSBridge.orders()}},"查看订单")))))}}]),t}(p.Component);t.default=(0,E.connect)()(y)},Gzmrbgut:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),a("OCQ/sAO2");var n=a("GiK3r5kD"),s=l(n),c=a("F8kArY4h"),r=a("1Ss0+nTi"),u=a("qLW/H28C"),i=l(u),o=a("l3OOmnmp"),d=l(o),m=a("1nGpSJ/k"),f=l(m),p=function(e){var t=e.location;return s.default.createElement(c.Switch,{location:t},s.default.createElement(c.Route,{exact:!0,path:"/cashier/payment",component:i.default}),s.default.createElement(c.Route,{exact:!0,path:"/cashier/success",component:d.default}),s.default.createElement(c.Route,{exact:!0,path:"/cashier/failure",component:f.default}),s.default.createElement(c.Route,{component:r.NoMatch}))};t.default=p},"OCQ/sAO2":function(e,t,a){var l=a("0u8huDBA");"string"==typeof l&&(l=[[e.i,l,""]]);var n={};n.transform=void 0;a("MTIv0jEu")(l,n);l.locals&&(e.exports=l.locals)},l3OOmnmp:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a("Zx67aMzV"),s=l(n),c=a("ZrlrdyRl"),r=l(c),u=a("wxAWXU5K"),i=l(u),o=a("zwoOJdCg"),d=l(o),m=a("Pf15lzEx"),f=l(m),p=a("GiK3r5kD"),h=l(p),E=a("RH2OZSPu"),v=a("pAQWTaDD"),g=a("6KlIuleq"),y=function(e){function t(){return(0,r.default)(this,t),(0,d.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,f.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this;return h.default.createElement(v.View,null,h.default.createElement(v.Header,null,h.default.createElement("a",{className:"menu",onClick:function(){return e.props.history.go(-1)}},h.default.createElement("i",{className:"icon"},"")),h.default.createElement(v.Title,{title:"支付成功"})),h.default.createElement(v.Content,null,h.default.createElement("div",{className:"feedback compact"},h.default.createElement("div",{className:"mark"},h.default.createElement("i",{className:"icon text-success"},"")),h.default.createElement("h3",{className:"title"},"支付成功"),h.default.createElement("div",{className:"describe"},"如有疑问，您可以致电 ",h.default.createElement("a",{className:"link",href:"tel:4000818181"},"4000818181")," 咨询"),h.default.createElement("div",{className:"vspace hspace"},h.default.createElement("button",{className:"button plain-success",onClick:function(){return g.JSBridge.orders()}},"查看订单")))))}}]),t}(p.Component);t.default=(0,E.connect)()(y)},"qLW/H28C":function(e,t,a){"use strict";(function(e){function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8wAUAV"),s=l(n),c=a("Gu7Tm2+A"),r=l(c),u=a("Zx67aMzV"),i=l(u),o=a("ZrlrdyRl"),d=l(o),m=a("wxAWXU5K"),f=l(m),p=a("zwoOJdCg"),h=l(p),E=a("Pf15lzEx"),v=l(E),g=a("OCQ/sAO2"),y=l(g),x=a("GiK3r5kD"),b=l(x),N=a("2KeSMhYv"),k=a("RH2OZSPu"),C=a("NE60SXLQ"),M=a("pAQWTaDD"),w=a("6KlIuleq"),A=function(t){function a(e){(0,d.default)(this,a);var t=(0,h.default)(this,(a.__proto__||(0,i.default)(a)).call(this,e));return t.handlePayment=function(){var e=t.state.list.find(function(e){return 1===e.defaultFlag});if(!e)return t.props.actions.openToast({icon:"failure",message:"请选支付方式"});11===e.type?t.handleCash(e):21===e.type?t.handleCard(e):31===e.type?t.handleAlipay(e):51===e.type?t.handleWeixin(e):61===e.type?t.handleWallet(e):t.handleOthers(e)},t.state={list:[],query:{},loading:!0},t}return(0,v.default)(a,t),(0,f.default)(a,[{key:"componentDidMount",value:function(){var t=this,a=this.props.actions,l=this.props.location.search,n=(0,w.decodeQuery)(l);if(!n.code||!n.price||!n.business)return a.openModal({title:"数据异常",message:"缺少必要的支付参数，无法支付",buttons:[{text:"关闭",onClick:a.closeModal}]});e.get("/cashier/ajax/method",{params:n,cache:!0}).then(function(e){var a=e.data,l=!1;a.onlinePayMethods=a.onlinePayMethods.filter(function(e){return 31===e.type&&w.Env.is("wx")?(l=1===e.defaultFlag||l,!1):!(51===e.type&&!w.Env.is("wx"))||(l=1===e.defaultFlag||l,!1)}),a.virtualPayMethods=a.virtualPayMethods.filter(function(e){return 61!==e.type?(l=1===e.defaultFlag||l,!1):0!==a.walletStatus.status||(l=1===e.defaultFlag||l,e.defaultFlag=0,!0)});var s=[].concat((0,r.default)(a.onlinePayMethods),(0,r.default)(a.virtualPayMethods),(0,r.default)(a.offlinePayMethods)),c=a.walletStatus;if(l){var u=s.find(function(e){return 61!==e.type||0!==c.status});u&&(u.defaultFlag=1,l=!1)}t.setState({list:s,wallet:c,query:n,lost:l,loading:!1})})}},{key:"handleChange",value:function(e){this.setState({list:this.state.list.map(function(t){return t.defaultFlag=t===e?1:0,t})})}},{key:"handleCash",value:function(){var e=this.props,t=e.actions,a=e.history;t.openModal({title:"现金支付",message:"您需要前往物业中心现金支付",buttons:[{text:"其他方式",onClick:t.closeModal},{text:"查看订单",onClick:function(){t.closeModal(),a.push("/account/orders")}}]})}},{key:"handleCard",value:function(){var e=this.props,t=e.actions,a=e.history;t.openModal({title:"刷卡支付",message:"您需要前往物业中心刷卡支付",buttons:[{text:"其他方式",onClick:t.closeModal},{text:"查看订单",onClick:function(){t.closeModal(),a.push("/account/orders")}}]})}},{key:"handleAlipay",value:function(){e.get("/cashier/ajax/alipay",{params:{code:this.state.query.code}}).then(function(e){var t=e.data;location.href=t.url})}},{key:"handleWeixin",value:function(){var t=this;e.get("/cashier/ajax/weixin",{params:{code:this.state.query.code}}).then(function(e){var a=e.data;WeixinJSBridge.invoke("getBrandWCPayRequest",a,function(e){"get_brand_wcpay_request:ok"===e.err_msg?t.handleFeedback("success"):t.handleFeedback("failure")})})}},{key:"handleWallet",value:function(){var t=this,a=null,l=this.props.actions,n=this.state,s=n.query,c=n.wallet,r=function(){var n=Math.pow(2,31)-1;l.openToast({icon:"loading",modal:!0},n),e.post("/cashier/ajax/wallet",{code:s.code,password:a},{global:!1}).then(function(){t.handleFeedback("success")},function(){t.handleFeedback("failure")}).finally(l.closeToast)};if(0==c.status)return l.openToast({icon:"failure",message:"账户已被冻结"});1==c.status?l.openModal({title:"请输入支付密码",message:b.default.createElement("div",{className:"list compact wallet"},b.default.createElement("label",{className:"item"},b.default.createElement("span",{className:"label"},"密码"),b.default.createElement("div",{className:"text"},b.default.createElement("input",{className:"input",type:"password",pattern:"[0-9]*",placeholder:"请输入您的支付密码",maxLength:"6",onChange:function(e){return a=e.target.value}}))),b.default.createElement("div",{className:"item-divider"},b.default.createElement("div",{className:"text text-center text-driving"},"提醒: 您正在进行付款操作"))),buttons:[{text:"取消",onClick:l.closeModal},{text:"确定",onClick:function(){if(!a)return l.openToast({icon:"failure",message:"请输入密码"});r(),l.closeModal()}}]}):2==c.status&&r()}},{key:"handleFeedback",value:function(e){var t=this.state.query;this.props.history.push({pathname:(0,w.payoff)(t.business,e),search:(0,w.encodeQuery)(t)})}},{key:"handleOthers",value:function(){var e=this.props,t=e.actions,a=e.history;t.openModal({title:"物业前台",message:"您需要前往物业中心当面支付",buttons:[{text:"其他方式",onClick:t.closeModal},{text:"查看订单",onClick:function(){t.closeModal(),a.push("/account/orders")}}]})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,l=t.list,n=t.wallet,s=t.query,c=t.lost,r=s.price,u=this.props,i=u.toast,o=u.modal;return b.default.createElement(M.View,{className:y.default.home},b.default.createElement(M.Header,null,b.default.createElement("a",{className:"menu",onClick:function(){return e.props.history.go(-1)}},b.default.createElement("i",{className:"icon"},"")),b.default.createElement(M.Title,{title:"收银台"})),b.default.createElement(M.Content,null,!a&&0===l.length&&b.default.createElement("div",{className:"feedback"},b.default.createElement("div",{className:"mark"},b.default.createElement("img",{width:"197",height:"98",src:"//img1.qdingnet.com/c50aee1127e2b6a075250a6b26629bd2.png",alt:"空白"})),b.default.createElement("h3",{className:"title"},"非常抱歉"),b.default.createElement("div",{className:"describe"},"您当前浏览器不支持支付",b.default.createElement("br",null),"你可以使用微信或千丁APP访问"),b.default.createElement("div",{className:"vspace hspace"},b.default.createElement("a",{className:"button default",href:"//dl.qdingnet.com"},"下载千丁小区"))),l.length>0&&b.default.createElement(M.Aux,null,b.default.createElement("div",{className:"hspace text-sm","ui-mode":"15px"},b.default.createElement("div",{className:"vspace","ui-mode":"10px"},"请选择支付方式")),l.map(function(t,a){return b.default.createElement("div",{key:a,className:"list"},61===t.type&&0==n.status&&b.default.createElement("label",{className:"item disabled","ui-mode":"15px"},b.default.createElement("div",{className:"avatar"},b.default.createElement("img",{width:"45",height:"45",src:t.icon})),b.default.createElement("span",{className:"text"},b.default.createElement("span",{className:"text-darkgray"},t.name,b.default.createElement("span",{className:"text-gray text-sm"},"（余额: ",w.Filter.currency(t.value),"）")),b.default.createElement("div",{className:"brief text-ellipsis"},b.default.createElement("span",{className:"text-gray"},n.statusTips||"提醒：钱包已被冻结，请联系客服")))),61===t.type&&1==n.status&&b.default.createElement("label",{className:"item tapable forlab","ui-mode":"15px"},b.default.createElement("div",{className:"avatar"},b.default.createElement("img",{width:"45",height:"45",src:t.icon})),b.default.createElement("span",{className:"text"},b.default.createElement("span",null,t.name,b.default.createElement("span",{className:"text-driving text-sm"},"（余额: ",w.Filter.currency(t.value),"）")),b.default.createElement("div",{className:"brief text-ellipsis"},t.desc)),b.default.createElement("input",{className:"checkbox",type:"radio",name:"paytype",checked:t.defaultFlag,onChange:e.handleChange.bind(e,t)})),61!==t.type&&b.default.createElement("label",{className:"item tapable forlab","ui-mode":"15px"},b.default.createElement("div",{className:"avatar"},b.default.createElement("img",{width:"45",height:"45",src:t.icon})),b.default.createElement("span",{className:"text"},b.default.createElement("span",null,t.name),b.default.createElement("div",{className:"brief text-ellipsis"},t.desc)),b.default.createElement("input",{className:"checkbox",type:"radio",name:"paytype",checked:t.defaultFlag,onChange:e.handleChange.bind(e,t)})))}))),l.length>0&&b.default.createElement(M.Footer,null,b.default.createElement("div",{className:"button-group compact"},b.default.createElement("button",{className:"button literal square text-left"},"应付: ",b.default.createElement("span",{className:"text-driving"},w.Filter.currency(r))),b.default.createElement("button",{className:"button driving square",disabled:c,onClick:this.handlePayment},"立即支付"))),b.default.createElement(M.Widgets,null,b.default.createElement(M.Modal,o),b.default.createElement(M.Toast,i)))}}]),a}(x.Component),_=function(e){return(0,s.default)({},e.modules.cashier.home)},O=function(e){return{actions:(0,N.bindActionCreators)(C.actions,e)}};t.default=(0,k.connect)(_,O)(A)}).call(t,a("mtWMgkpO"))}});
//# sourceMappingURL=cashier.bundle.js.map